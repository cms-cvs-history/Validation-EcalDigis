process EcalHitsValid  = 
	{

  untracked PSet maxEvents = {untracked int32 input = 100}

  service = RandomNumberGeneratorService
  {
     untracked uint32 sourceSeed = 98765
      PSet moduleSeeds = 
      {
         untracked uint32 g4SimHits = 9876
         untracked uint32 mix = 1234
         untracked uint32 simEcalUnsuppressedDigis = 12345
    	 untracked uint32 ecalMixingModuleValidation = 12345
      }
  }

  module randomEngineStateProducer = RandomEngineStateProducer { }

   # use predefined fixed guns in barrel and endcap
   #
   source = MCFileSource
   {
      untracked vstring fileNames = {'file:Photon_E30GeV_fixed.dat'}
   }

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"   

  # initialize magnetic field
  include "Configuration/StandardSequences/data/MagneticField.cff"

  # geometry (Only Ecal)
  include "Geometry/EcalCommonData/data/EcalOnly.cfi"

  include "Geometry/CaloEventSetup/data/CaloGeometry.cff"

  include "Geometry/CaloEventSetup/data/EcalTrigTowerConstituents.cfi"

  include "Geometry/EcalMapping/data/EcalMapping.cfi"

  include "Geometry/EcalMapping/data/EcalMappingRecord.cfi"

  module o1 = PoolOutputModule { 
         untracked string fileName = "MixingModule_fixed1_all_EcalValidation.root"      
  }
                                                                                
  # DQM services
  include "DQMServices/Core/data/DQM.cfg"
  replace DQM.collectorHost = ""

  service = Timing{ }
  
  service = SimpleMemoryCheck{ }

  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

  # run simulation, with EcalHits Validation specific watcher 
  include "SimG4Core/Application/data/g4SimHits.cfi"
  replace g4SimHits.Generator.HepMCProductLabel = "source"		
		
  # Mixing Module
  include "SimGeneral/MixingModule/data/mixLowLumPU.cfi"
  replace mix.input.fileNames = {'file:MixingModule_noPileup_all_EcalValidation.root'}
  replace mix.input.type = "fixed"
  replace mix.minBunch = -5
  replace mix.maxBunch = 3
  replace mix.input.nbPileupEvents= {double averageNumber=1}

  include "CalibCalorimetry/Configuration/data/Ecal_FakeConditions.cff"

  # ECAL digitization sequence
  include "SimCalorimetry/Configuration/data/ecalDigiSequence.cff" 

  # ECAL digis validation sequence
  include "Validation/EcalDigis/data/ecalDigisValidationSequence.cff"
       
  # ECAL Mixing Module specific validation
  include "Validation/EcalDigis/data/ecalMixingModuleValidation.cfi"

  sequence simhits = { g4SimHits }
  sequence digis = { mix , ecalDigiSequence , ecalDigisValidationSequence , ecalMixingModuleValidation }

  path p1 = { simhits }
  path p2 = { digis } 
  path p4 = { randomEngineStateProducer }
  endpath outpath = { o1 }

  schedule = { p1, p2, p4, outpath }   

  }		
