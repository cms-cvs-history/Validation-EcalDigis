process testECALDigi = 
{

  service = Timing { } 

  service = MessageLogger { 
    untracked vstring destinations = {"cout"}
#    untracked vstring categories = { "EcalShape","EcalCoder","EcalDigi" }
#    untracked vstring debugModules = {"ecaldigi"}
    untracked PSet cout = { 
#      untracked string threshold = "DEBUG" 
#      untracked PSet DEBUG = { untracked int32 limit = 0 }
      untracked PSet INFO = { untracked int32 limit = -1 }
#      untracked PSet EcalShape = { untracked int32 limit = 10000000 }
#      untracked PSet EcalCoder = { untracked int32 limit = 10000000 }
#      untracked PSet EcalDigi  = { untracked int32 limit = 10000000 }
    }
  }

  # input
  source = PoolSource {
     untracked vstring fileNames = {'file:simevent.root'}
     untracked int32 maxEvents = -1
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
  }

  #Geometry
  #
  include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
  # output
  module out = PoolOutputModule 
   {	
      untracked string fileName = 'digis.root'
   }

   module mix = MixingModule {
         secsource input = PoolRASource  {
		 untracked vstring fileNames = {'file:simevent.root'}
         string type = "poisson"
         double averageNumber = 0
         int32 minBunch = xxx
         int32 maxBunch = xxx
         int32 seed = 1234567
         }
         int32 bunchspace = 25
   }

  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

  # use trivial ESProducer for tests
  es_source = EcalTrivialConditionRetriever { }

  include "SimCalorimetry/EcalSimProducers/data/ecaldigi.cfi"

  path p = { mix, ecaldigi }
  endpath fine = { out }

}

