process testECALDigi2 = 
{

  service = Timing { } 

  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  # input
  source = PoolSource {
     untracked vstring fileNames = {'file:simevent.root'}
     untracked int32 maxEvents = -1
     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
  }

  #Geometry
  #
  include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
  # output
  module out = PoolOutputModule 
   {	
      untracked string fileName = 'digis.root'
   }

  # Mixing Module (for pileup simulation)
  include "SimGeneral/MixingModule/data/mix.cfi"
  replace mix.input.fileNames = {'file:simevent.root'}
  replace mix.input.type = "fixed"
  replace mix.input.averageNumber = 1
  replace mix.input.minBunch = -5
  replace mix.input.maxBunch = 3

  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

  # use trivial ESProducer for tests
  include "CalibCalorimetry/EcalTrivialCondModules/data/EcalTrivialCondRetriever.cfi"

  include "SimCalorimetry/EcalSimProducers/data/ecaldigi.cfi"

  path p = { mix, ecalUnsuppressedDigis }
  endpath fine = { out }

}

