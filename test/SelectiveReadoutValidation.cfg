process EcalSelectiveReadoutValid  = {

    untracked PSet maxEvents = {untracked int32 input = 20}

    source = PoolSource {
         #
	 #  Note for Xingtao :
	 # this "/store/..." thing below shows how to read from 
	 # dCache the newly regenerated Photon30GeV_all sample;
	 #
	 # Remember : this only works if one runs in b-shell !!!
	 #
	 # the full path to the new photon sample is this :
	 # /pnfs/cms/WAX/11/store/unmerged/PreProd/2006/10/3/SVSuite100-EcalHits-Photon30GeVAll-GenEvents/GEN/0000/48E9CC58-2853-DB11-969D-003048767D3D.root
	 # you can also copy it overm using dccp, from dCache  
	 # to your work area and use locally
	 #
	 # untracked vstring fileNames = 
	 # {"/store/unmerged/PreProd/2006/10/3/SVSuite100-EcalHits-Photon30GeVAll-GenEvents/GEN/0000/48E9CC58-2853-DB11-969D-003048767D3D.root"}
	 #
         untracked vstring fileNames = {'file:Photon_E30GeV_all.root'}

      # untracked vstring fileNames = {'/store/PreProd/2007/2/6/SVSuite122-EcalChain-Photon30GeV-All-GenEvents/0000/E23BD2B9-2BB6-DB11-B2DF-00304870DCA9.root'}

         #untracked string catalog = 'PoolFileCatalog.xml'
    }
     
  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"   

  # initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # geometry (Only Ecal)
  include "Geometry/EcalCommonData/data/EcalOnly.cfi"

  es_module = TrackerGeometricDetESModule {}
   
  module o1 = PoolOutputModule { 
         untracked string fileName = "Photon_E30GeV_all_EcalValidation.root"      
         untracked vstring outputCommands = 
         {  
           "keep *",
           "drop *_ecalUnsuppressedDigis_*_*",
           "drop *_ecalDigis_*_*",
           "drop *_ecalPreshowerDigis_*_*"
          }

  }
                                                                                
  # DQM services
  service = DaqMonitorROOTBackEnd{ }

    service = RandomNumberGeneratorService
    {
        PSet moduleSeeds =
        {
            untracked uint32 g4SimHits = 9876
        }
    }

  service = Timing{ }
  
  service = SimpleMemoryCheck{ }

  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

  # run simulation, with EcalHits Validation specific watcher 
  include "SimG4Core/Application/data/SimG4Object.cfi"
  replace g4SimHits.Generator.HepMCProductLabel = "source"
#  replace g4SimHits.Watchers = {
#       { string type = "EcalSimHitsValidProducer"
#         untracked string instanceLabel="EcalValidInfo"
#         untracked bool verbose = false
#       }
#  }
		
  # Mixing Module
  include "SimGeneral/MixingModule/data/mixNoPU.cfi"

  include "CalibCalorimetry/Configuration/data/Ecal_FakeConditions.cff"

  # ECAL digitization sequence
  include "SimCalorimetry/EcalSimProducers/data/ecalDigiSequence.cff" 

  replace ecalDigis.writeSrFlags = true

  # ECAL digis validation sequence
  include "Validation/EcalDigis/data/ecalDigisValidationSequence.cff"
  
  # Defines Ecal seletive readout validation module, ecalSelectiveReadoutValidation:
  include "Validation/EcalDigis/data/ecalSelectiveReadoutValidation.cfi"
     
  path p1 = { g4SimHits , mix , ecalDigiSequence , ecalSelectiveReadoutValidation }
  endpath outpath = { o1 }
}		
